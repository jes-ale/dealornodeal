import{_ as j}from"./E63WEL4W.js";import{h as L,r as w,E as D,g as M,Q as N,i as P,o,c as a,a as t,B as m,C as g,b,u as $,F as c,z as u,I as C,t as k,p as R,e as A,_ as Q,D as T,w as z}from"./qlvJx28p.js";import{u as G}from"./DKQTjIAd.js";import{E as V}from"./DPlZ69ra.js";import{I}from"./Cncj-WJO.js";const _=r=>(R("data-v-7efb7493"),r=r(),A(),r),H={class:"flex w-full h-full justify-start items-center flex-col"},J={class:"flex justify-start items-center w-full"},K={class:"flex flex-col w-full"},O=["onUpdate:modelValue"],W=_(()=>t("option",{disabled:"",value:""},"Select field",-1)),X=["value"],Y=["onUpdate:modelValue"],Z=_(()=>t("option",{value:"equals"},"Equals",-1)),ee=_(()=>t("option",{value:"contains"},"Contains",-1)),te=_(()=>t("option",{value:"starts_with"},"Starts with",-1)),le=_(()=>t("option",{value:"ends_with"},"Ends with",-1)),se=[Z,ee,te,le],oe=["onUpdate:modelValue"],ae=["onClick"],ne={class:"min-w-full border-collapse"},re=["onClick"],ie=L({__name:"ListView",props:{collection:{type:String,required:!0},fields:{type:Array,required:!0}},setup(r){const p=r,{pb:x}=G(),d=w(""),f=w([]),v=w([]),q=D(),h=async()=>{V.emit("loading",{show:!0});try{const l=S(),e=await x.collection(p.collection).getFullList({filter:l});f.value=e}catch(l){console.error("Error fetching items:",l)}finally{V.emit("loading",{show:!1})}},S=()=>{const l=[];return d.value&&l.push(y.value.map(e=>`${e.field_name} ~ "${d.value}"`).join(" || ")),v.value.forEach(e=>{if(e.field&&e.condition&&e.value)switch(e.condition){case"equals":l.push(`${e.field} = "${e.value}"`);break;case"contains":l.push(`${e.field} ~ "${e.value}"`);break;case"starts_with":l.push(`${e.field} ~ "^${e.value}"`);break;case"ends_with":l.push(`${e.field} ~ "${e.value}$"`);break}}),l.length>0?l.join(" && "):null},U=()=>{v.value.push({field:"",condition:"equals",value:""})},E=l=>{v.value.splice(l,1)},y=M(()=>p.fields.filter(l=>l.visible)),B=N(),F=l=>{const e=B.path.split("/")[1];q.push(`/${e}/form/${l}`)};return P(h),(l,e)=>(o(),a("div",H,[t("div",J,[m(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),onInput:h,placeholder:"Search...",class:"border-x border-black p-2 bg-rose-100 w-full"},null,544),[[g,d.value]]),t("button",{onClick:U,class:"p-2 h-full w-auto"},[b($(I),{icon:"fluent:filter-add-20-filled"})]),t("button",{onClick:h,class:"border-x border-black p-2 h-full w-auto"},[b($(I),{icon:"carbon:query"})])]),t("div",K,[(o(!0),a(c,null,u(v.value,(s,i)=>(o(),a("div",{key:i,class:"flex border-t border-black w-full"},[m(t("select",{"onUpdate:modelValue":n=>s.field=n,class:"border-r border-black p-2 bg-transparent w-full"},[W,(o(!0),a(c,null,u(r.fields,n=>(o(),a("option",{key:n.id,value:n.field_name},k(n.field_name),9,X))),128))],8,O),[[C,s.field]]),m(t("select",{"onUpdate:modelValue":n=>s.condition=n,class:"border-r border-black p-2 bg-transparent w-full"},se,8,Y),[[C,s.condition]]),m(t("input",{type:"text","onUpdate:modelValue":n=>s.value=n,class:"border-r border-black p-2 bg-rose-100 w-full"},null,8,oe),[[g,s.value]]),t("button",{onClick:n=>E(i),class:"p-2 w-full hover:bg-rose-100"},"Remove",8,ae)]))),128))]),t("table",ne,[t("thead",null,[t("tr",null,[(o(!0),a(c,null,u(y.value,s=>(o(),a("th",{key:s.id,class:"border border-black p-2 bg-rose-100"},k(s.field_name.charAt(0).toUpperCase()+s.field_name.slice(1)),1))),128))])]),t("tbody",null,[(o(!0),a(c,null,u(f.value,s=>(o(),a("tr",{key:s.id,class:"even:bg-rose-100",onClick:i=>F(s.id)},[(o(!0),a(c,null,u(y.value,i=>(o(),a("td",{key:i.id,class:"border border-black p-2"},k(s[i.field_name]),1))),128))],8,re))),128))])])]))}}),de=Q(ie,[["__scopeId","data-v-7efb7493"]]),ce={class:"w-full h-full flex items-center justify-center"},ue="internal_users",be={__name:"list",setup(r){T();const p=[{field_name:"username",visible:!0,readonly:!1,id:"username"},{field_name:"verified",visible:!0,readonly:!1,id:"verified"},{field_name:"email",visible:!0,readonly:!1,id:"email"},{field_name:"created",visible:!0,readonly:!0,id:"created"},{field_name:"updated",visible:!0,readonly:!0,id:"updated"},{field_name:"avatar",visible:!0,readonly:!1,id:"avatar"},{field_name:"roles",visible:!0,readonly:!1,id:"roles"},{field_name:"contact_fk",visible:!0,readonly:!1,id:"contact_fk"},{field_name:"company_id",visible:!0,readonly:!1,id:"company_id"}];return(x,d)=>{const f=j;return o(),a("div",null,[b(f,{name:"default"},{default:z(()=>[t("div",ce,[b(de,{collection:ue,fields:p})])]),_:1})])}}};export{be as default};
